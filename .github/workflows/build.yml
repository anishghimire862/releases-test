name: Build Test
on:
  push:
    branches:
      - 'master'
      - 'rel/**'

jobs:
  build-macos:
    runs-on: macos-latest

    steps:
      - name: Set R2 destination directory for production release
        run: |
          echo "R2_DESTINATION_DIR=prod/latest/mac" >> $GITHUB_ENV

      - name: Create files
        run: |
         mkdir temp_upload
         touch temp_upload/file1 temp_upload/file2 temp_upload/file3
      
      - name: Upload artifacts
        uses: ryand56/r2-upload-action@latest
        with:
          r2-account-id: ${{ secrets.R2_ACCOUNT_ID }}
          r2-access-key-id: ${{ secrets.R2_ACCESS_KEY_ID }}
          r2-secret-access-key: ${{ secrets.R2_SECRET_ACCESS_KEY }}
          r2-bucket: ${{ secrets.R2_BUCKET }}
          source-dir: temp_upload/
          destination-dir: ${{ env.R2_DESTINATION_DIR }}
          keep-file-fresh: true
        

        
